// Full implementation provided in previous messages, refer back for full details.
